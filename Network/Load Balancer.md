# Load Balancer

여러 대의 서버를 두고 서비스를 제공할 경우 분산 처리 역할을 담당

- 서버 분산 처리 방식

  - Scale Up  
    서버 자체의 성능을 확장

  - Scale Out  
    기존 서버와 동일하거나 낮은 스펙의 서버를 추가로 증설

Scale Out을 할 경우 로드밸런싱이 필요하며,  
로드밸런싱 알고리즘의 종류에는 여러가지가 있다.

- 라운드로빈 방식(Round Robin Method)  
   서버에 들어온 요청을 순서대로 돌아가며 분배하는 방식  
   => 서버가 동일 스펙이고 세션이 오래 지속되지 않는 경우 적합

- 가중 라운드로빈 방식 (Weighted Round Robin Method)  
  각각의 서버마다 가중치를 매기고 가중치가 높은 서버순으로 요청을 분배  
  => 주로 서버의 트래픽 처리 능력이 상이한 경우 사용됨

- IP 해시 방식 (IP Hash Method)  
   클라이언트의 IP 주소를 특정 서버로 매핑하여 요청을 처리하는 방식  
   => 사용자의 IP를 해싱해서 특정 사용자가 항상 동일한 서버로 연결되는것을 보장함

- 최소 연결 방식 (Least Connection Method)  
  요청이 들어온 시점에 가장 적은 연결상태로 보이는 서버에 요청을 분배  
  => 요청의 세션이 길거나, 서버에 분배된 트래픽들이 일정하지 않은 경우 사용

- 최소 리스폰타임 (Least Response Time Method)  
  현재 연결 상태와 응답시간을 고려해 가장 짧은 응답시간을 도출하는 서버에 우선적으로 요청을 분배함

상용 서비스에선 L4, L7레이어의 로드밸런서를 주로 사용함,  
L4 로드밸런서부터 포트 포워딩이 가능하기 때문

내가 주로쓰던 AWS의 ALB(Application Loaad Balancer)는 L7 레이어의 로드밸런서이며,  
L7 로드밸런서에서는 L4 로드밸런서에서 제어가 가능한 IP, TCP, UDP 뿐 아니라 HTTP 헤더, 쿠키, 패스 파라미터 등으로도 트래픽 제어가 가능함
